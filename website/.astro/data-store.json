[["Map",1,2,9,10],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.16.4","content-config-digest","11a8b294d7377aec","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://varvedb.com\",\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":{\"type\":\"shiki\",\"excludeLangs\":[\"math\"]},\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[],\"rehypePlugins\":[],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true,\"allowedDomains\":[]},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"staticImportMetaEnv\":false,\"chromeDevtoolsWorkspace\":false,\"failOnPrerenderConflict\":false,\"svgo\":false},\"legacy\":{\"collections\":false}}","docs",["Map",11,12,49,50,82,83,109,110,142,143],"architecture",{"id":11,"data":13,"body":14,"filePath":15,"digest":16,"rendered":17,"legacyId":48},{},"# Architecture\n\nVarveDB is built on a layered architecture that separates storage concerns from the high-level event sourcing API.\n\n## High-Level Overview\n\nThe system consists of three main components that interact with the underlying storage:\n\n1.  **Writer**: Handles appending events to the log. It manages transactions, concurrency control, and encryption.\n2.  **Reader**: Provides efficient access to stored events. It uses zero-copy deserialization to read data directly from the memory-mapped file.\n3.  **Processor**: A background task that subscribes to new events and dispatches them to registered handlers.\n\n```mermaid\nflowchart TD\n    %% Custom Styles\n    classDef user fill:#eff6ff,stroke:#1d4ed8,stroke-width:2px,color:#1e3a8a,rx:10,ry:10;\n    classDef component fill:#f0fdf4,stroke:#15803d,stroke-width:2px,color:#14532d,rx:5,ry:5;\n    classDef storage fill:#fff7ed,stroke:#c2410c,stroke-width:2px,color:#7c2d12,shape:cylinder;\n    classDef bus fill:#faf5ff,stroke:#7e22ce,stroke-width:2px,color:#581c87,rx:20,ry:20;\n    classDef subgraphStyle fill:#ffffff,stroke:#94a3b8,stroke-width:2px,stroke-dasharray: 5 5,color:#475569;\n\n    User[\"ðŸ‘¤ User Application\"]:::user\n\n    subgraph VarveDB [\"ðŸ“¦ VarveDB\"]\n        direction TB\n        Writer[\"âœï¸ Writer&lt;E&gt;\"]:::component\n        Reader[\"ðŸ“– Reader&lt;E&gt;\"]:::component\n        Processor[\"âš™ï¸ Processor\"]:::component\n        \n        subgraph Storage [\"ðŸ’¾ LMDB Environment\"]\n            direction TB\n            Events[(\"events_log\u003Cbr/>(Seq âž¡ Bytes)\")]:::storage\n            Index[(\"stream_index\u003Cbr/>(StreamID+Ver âž¡ Seq)\")]:::storage\n            Cursors[(\"consumer_cursors\u003Cbr/>(Name âž¡ Seq)\")]:::storage\n            KeyStore[(\"keystore\u003Cbr/>(StreamID âž¡ Key)\")]:::storage\n        end\n        \n        Bus([\"âš¡ Tokio Watch Bus\"]):::bus\n    end\n\n    User -->|Append| Writer\n    User -->|Read| Reader\n    User -->|Subscribe| Processor\n    \n    Writer -->|Write| Events\n    Writer -->|Write| Index\n    Writer -->|Notify| Bus\n    \n    Reader -->|Zero-Copy Read| Events\n    \n    Processor -->|Listen| Bus\n    Processor -->|Load/Save| Cursors\n    Processor -->|Handle| User\n    \n    %% Apply styles to subgraphs\n    class VarveDB,Storage subgraphStyle\n```\n\n## Storage Layer (LMDB)\n\nVarveDB uses **LMDB** as its storage engine. LMDB is a B-tree-based key-value store that is memory-mapped, providing read performance comparable to in-memory data structures.\n\n### Data Layout\n\nData is organized into several \"databases\" (tables) within the LMDB environment:\n\n*   **`events_log`**: The main append-only log.\n    *   **Key**: Global Sequence Number (`u64`, big-endian).\n    *   **Value**: Serialized event data (rkyv bytes).\n*   **`stream_index`**: Maps stream versions to global sequence numbers.\n    *   **Key**: `StreamID` + `StreamVersion`.\n    *   **Value**: Global Sequence Number.\n*   **`consumer_cursors`**: Tracks the progress of event processors.\n    *   **Key**: Consumer Group Name (`String`).\n    *   **Value**: Last Processed Global Sequence Number.\n*   **`keystore`**: Stores encryption keys for streams (if encryption is enabled).\n    *   **Key**: `StreamID`.\n    *   **Value**: Encrypted Stream Key (wrapped with Master Key).\n\n## Serialization (rkyv)\n\nVarveDB uses **rkyv** for serialization. Unlike Serde, which typically deserializes data into new heap-allocated structs, rkyv guarantees a memory representation that is the same on disk as it is in memory.\n\nThis allows the `Reader` to return references to the data inside the memory-mapped file, completely avoiding memory allocation and copying during reads.\n\n## Concurrency Model\n\n*   **Writes**: LMDB allows only one write transaction at a time. The `Writer` ensures that appends are serialized.\n*   **Reads**: Multiple read transactions can occur in parallel without blocking writes.\n*   **Optimistic Concurrency**: When appending to a stream, the user must provide the *expected* version of that stream. If the current version in the `stream_index` does not match, the write is rejected with a `ConcurrencyConflict` error.\n\n## Encryption\n\nWhen encryption is enabled:\n1.  A unique 256-bit key is generated for each new stream.\n2.  This stream key is encrypted (wrapped) using the provided **Master Key** and stored in the `keystore`.\n3.  Events appended to the stream are encrypted using the stream key and AES-256-GCM.\n4.  The `StreamID` and `SequenceNumber` are used as Additional Authenticated Data (AAD) to bind the ciphertext to its specific location, preventing replay attacks (e.g., copying a valid encrypted event from one stream to another).","src/content/docs/architecture.md","0ed145a2d66dc741",{"html":18,"metadata":19},"\u003Ch1 id=\"architecture\">Architecture\u003C/h1>\n\u003Cp>VarveDB is built on a layered architecture that separates storage concerns from the high-level event sourcing API.\u003C/p>\n\u003Ch2 id=\"high-level-overview\">High-Level Overview\u003C/h2>\n\u003Cp>The system consists of three main components that interact with the underlying storage:\u003C/p>\n\u003Col>\n\u003Cli>\u003Cstrong>Writer\u003C/strong>: Handles appending events to the log. It manages transactions, concurrency control, and encryption.\u003C/li>\n\u003Cli>\u003Cstrong>Reader\u003C/strong>: Provides efficient access to stored events. It uses zero-copy deserialization to read data directly from the memory-mapped file.\u003C/li>\n\u003Cli>\u003Cstrong>Processor\u003C/strong>: A background task that subscribes to new events and dispatches them to registered handlers.\u003C/li>\n\u003C/ol>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"mermaid\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">flowchart TD\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    %% Custom Styles\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    classDef user fill:#eff6ff,stroke:#1d4ed8,stroke-width:2px,color:#1e3a8a,rx:10,ry:10;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    classDef component fill:#f0fdf4,stroke:#15803d,stroke-width:2px,color:#14532d,rx:5,ry:5;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    classDef storage fill:#fff7ed,stroke:#c2410c,stroke-width:2px,color:#7c2d12,shape:cylinder;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    classDef bus fill:#faf5ff,stroke:#7e22ce,stroke-width:2px,color:#581c87,rx:20,ry:20;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    classDef subgraphStyle fill:#ffffff,stroke:#94a3b8,stroke-width:2px,stroke-dasharray: 5 5,color:#475569;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    User[\"ðŸ‘¤ User Application\"]:::user\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    subgraph VarveDB [\"ðŸ“¦ VarveDB\"]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        direction TB\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        Writer[\"âœï¸ Writer&#x26;lt;E&#x26;gt;\"]:::component\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        Reader[\"ðŸ“– Reader&#x26;lt;E&#x26;gt;\"]:::component\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        Processor[\"âš™ï¸ Processor\"]:::component\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        subgraph Storage [\"ðŸ’¾ LMDB Environment\"]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            direction TB\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            Events[(\"events_log&#x3C;br/>(Seq âž¡ Bytes)\")]:::storage\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            Index[(\"stream_index&#x3C;br/>(StreamID+Ver âž¡ Seq)\")]:::storage\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            Cursors[(\"consumer_cursors&#x3C;br/>(Name âž¡ Seq)\")]:::storage\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            KeyStore[(\"keystore&#x3C;br/>(StreamID âž¡ Key)\")]:::storage\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        end\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        Bus([\"âš¡ Tokio Watch Bus\"]):::bus\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    end\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    User -->|Append| Writer\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    User -->|Read| Reader\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    User -->|Subscribe| Processor\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    Writer -->|Write| Events\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    Writer -->|Write| Index\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    Writer -->|Notify| Bus\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    Reader -->|Zero-Copy Read| Events\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    Processor -->|Listen| Bus\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    Processor -->|Load/Save| Cursors\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    Processor -->|Handle| User\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    %% Apply styles to subgraphs\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    class VarveDB,Storage subgraphStyle\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"storage-layer-lmdb\">Storage Layer (LMDB)\u003C/h2>\n\u003Cp>VarveDB uses \u003Cstrong>LMDB\u003C/strong> as its storage engine. LMDB is a B-tree-based key-value store that is memory-mapped, providing read performance comparable to in-memory data structures.\u003C/p>\n\u003Ch3 id=\"data-layout\">Data Layout\u003C/h3>\n\u003Cp>Data is organized into several â€œdatabasesâ€ (tables) within the LMDB environment:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>\u003Ccode>events_log\u003C/code>\u003C/strong>: The main append-only log.\n\u003Cul>\n\u003Cli>\u003Cstrong>Key\u003C/strong>: Global Sequence Number (\u003Ccode>u64\u003C/code>, big-endian).\u003C/li>\n\u003Cli>\u003Cstrong>Value\u003C/strong>: Serialized event data (rkyv bytes).\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\u003Cstrong>\u003Ccode>stream_index\u003C/code>\u003C/strong>: Maps stream versions to global sequence numbers.\n\u003Cul>\n\u003Cli>\u003Cstrong>Key\u003C/strong>: \u003Ccode>StreamID\u003C/code> + \u003Ccode>StreamVersion\u003C/code>.\u003C/li>\n\u003Cli>\u003Cstrong>Value\u003C/strong>: Global Sequence Number.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\u003Cstrong>\u003Ccode>consumer_cursors\u003C/code>\u003C/strong>: Tracks the progress of event processors.\n\u003Cul>\n\u003Cli>\u003Cstrong>Key\u003C/strong>: Consumer Group Name (\u003Ccode>String\u003C/code>).\u003C/li>\n\u003Cli>\u003Cstrong>Value\u003C/strong>: Last Processed Global Sequence Number.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\u003Cstrong>\u003Ccode>keystore\u003C/code>\u003C/strong>: Stores encryption keys for streams (if encryption is enabled).\n\u003Cul>\n\u003Cli>\u003Cstrong>Key\u003C/strong>: \u003Ccode>StreamID\u003C/code>.\u003C/li>\n\u003Cli>\u003Cstrong>Value\u003C/strong>: Encrypted Stream Key (wrapped with Master Key).\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"serialization-rkyv\">Serialization (rkyv)\u003C/h2>\n\u003Cp>VarveDB uses \u003Cstrong>rkyv\u003C/strong> for serialization. Unlike Serde, which typically deserializes data into new heap-allocated structs, rkyv guarantees a memory representation that is the same on disk as it is in memory.\u003C/p>\n\u003Cp>This allows the \u003Ccode>Reader\u003C/code> to return references to the data inside the memory-mapped file, completely avoiding memory allocation and copying during reads.\u003C/p>\n\u003Ch2 id=\"concurrency-model\">Concurrency Model\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Cstrong>Writes\u003C/strong>: LMDB allows only one write transaction at a time. The \u003Ccode>Writer\u003C/code> ensures that appends are serialized.\u003C/li>\n\u003Cli>\u003Cstrong>Reads\u003C/strong>: Multiple read transactions can occur in parallel without blocking writes.\u003C/li>\n\u003Cli>\u003Cstrong>Optimistic Concurrency\u003C/strong>: When appending to a stream, the user must provide the \u003Cem>expected\u003C/em> version of that stream. If the current version in the \u003Ccode>stream_index\u003C/code> does not match, the write is rejected with a \u003Ccode>ConcurrencyConflict\u003C/code> error.\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"encryption\">Encryption\u003C/h2>\n\u003Cp>When encryption is enabled:\u003C/p>\n\u003Col>\n\u003Cli>A unique 256-bit key is generated for each new stream.\u003C/li>\n\u003Cli>This stream key is encrypted (wrapped) using the provided \u003Cstrong>Master Key\u003C/strong> and stored in the \u003Ccode>keystore\u003C/code>.\u003C/li>\n\u003Cli>Events appended to the stream are encrypted using the stream key and AES-256-GCM.\u003C/li>\n\u003Cli>The \u003Ccode>StreamID\u003C/code> and \u003Ccode>SequenceNumber\u003C/code> are used as Additional Authenticated Data (AAD) to bind the ciphertext to its specific location, preventing replay attacks (e.g., copying a valid encrypted event from one stream to another).\u003C/li>\n\u003C/ol>",{"headings":20,"localImagePaths":44,"remoteImagePaths":45,"frontmatter":46,"imagePaths":47},[21,24,28,31,35,38,41],{"depth":22,"slug":11,"text":23},1,"Architecture",{"depth":25,"slug":26,"text":27},2,"high-level-overview","High-Level Overview",{"depth":25,"slug":29,"text":30},"storage-layer-lmdb","Storage Layer (LMDB)",{"depth":32,"slug":33,"text":34},3,"data-layout","Data Layout",{"depth":25,"slug":36,"text":37},"serialization-rkyv","Serialization (rkyv)",{"depth":25,"slug":39,"text":40},"concurrency-model","Concurrency Model",{"depth":25,"slug":42,"text":43},"encryption","Encryption",[],[],{},[],"architecture.md","example",{"id":49,"data":51,"body":52,"filePath":53,"digest":54,"rendered":55,"legacyId":81},{},"# Example: Bank Ledger\n\nIn this tutorial, we will build a simple **Bank Ledger** application. We will track account balances by storing `Deposit` and `Withdraw` events.\n\n## 1. Setup\n\nCreate a new Rust project:\n\n```bash\ncargo new bank_ledger\ncd bank_ledger\n```\n\nAdd dependencies to `Cargo.toml`:\n\n```toml\n[dependencies]\nvarvedb = { path = \"../varvedb\" } # Adjust path if needed\nrkyv = \"0.8\"\ntokio = { version = \"1\", features = [\"full\", \"macros\"] }\nserde = { version = \"1\", features = [\"derive\"] }\nanyhow = \"1.0\"\n```\n\n## 2. Define Events\n\nWe'll define an enum to represent our transaction events.\n\n```rust\nuse rkyv::{Archive, Serialize, Deserialize};\n\n#[derive(Archive, Serialize, Deserialize, Debug, Clone)]\n#[rkyv(derive(Debug))]\npub enum BankEvent {\n    AccountCreated { owner: String },\n    Deposited { amount: u64 },\n    Withdrawn { amount: u64 },\n}\n```\n\n## 3. The Application Logic\n\nWe'll create a main function that initializes the database, writes some transactions, and then processes them to calculate the final balance.\n\n```rust\nuse varvedb::storage::{Storage, StorageConfig};\nuse varvedb::engine::{Writer, Reader, Processor, EventHandler};\nuse varvedb::error::Result;\nuse std::collections::HashMap;\n\n// ... BankEvent definition ...\n\nstruct BalanceProjector {\n    balances: HashMap\u003CString, u64>,\n}\n\nimpl EventHandler\u003CBankEvent> for BalanceProjector {\n    fn handle(&mut self, event: &ArchivedBankEvent) -> Result\u003C()> {\n        // In a real app, we'd need the stream ID (account ID) here.\n        // For simplicity, let's assume a single global account for this demo,\n        // or we could embed the account ID in the event.\n        match event {\n            ArchivedBankEvent::AccountCreated { owner } => {\n                println!(\"New account for: {}\", owner);\n            }\n            ArchivedBankEvent::Deposited { amount } => {\n                println!(\"Depositing: {}\", amount);\n            }\n            ArchivedBankEvent::Withdrawn { amount } => {\n                println!(\"Withdrawing: {}\", amount);\n            }\n        }\n        Ok(())\n    }\n}\n\n#[tokio::main]\nasync fn main() -> anyhow::Result\u003C()> {\n    // 1. Setup Storage\n    let config = StorageConfig::default();\n    let storage = Storage::open(config)?;\n    \n    let mut writer = Writer::\u003CBankEvent>::new(storage.clone());\n    let reader = Reader::\u003CBankEvent>::new(storage.clone());\n\n    // 2. Simulate Transactions\n    let account_id = \"account-1\";\n    \n    // Create Account\n    writer.append(account_id, 0, BankEvent::AccountCreated { \n        owner: \"Alice\".to_string() \n    })?;\n\n    // Deposit 100\n    writer.append(account_id, 1, BankEvent::Deposited { amount: 100 })?;\n\n    // Withdraw 50\n    writer.append(account_id, 2, BankEvent::Withdrawn { amount: 50 })?;\n\n    println!(\"Transactions committed.\");\n\n    // 3. Process Events\n    let rx = writer.subscribe();\n    let handler = BalanceProjector { balances: HashMap::new() };\n    \n    // Create a unique consumer ID\n    use std::hash::{Hash, Hasher};\n    let mut hasher = std::collections::hash_map::DefaultHasher::new();\n    \"balance-projector\".hash(&mut hasher);\n    let consumer_id = hasher.finish();\n\n    let mut processor = Processor::new(reader, handler, consumer_id, rx);\n\n    // Run the processor (in a real app, this would be a background task)\n    // We'll run it in a separate task and wait a bit for it to catch up\n    tokio::spawn(async move {\n        if let Err(e) = processor.run().await {\n            eprintln!(\"Processor error: {}\", e);\n        }\n    });\n\n    // Give the processor a moment to run\n    tokio::time::sleep(std::time::Duration::from_secs(1)).await;\n\n    Ok(())\n}\n```\n\n## 4. Running the Example\n\nRun the application:\n\n```bash\ncargo run\n```\n\nYou should see the output reflecting the processed events.\n\n## Conclusion\n\nYou've built a simple event-sourced application with VarveDB! You learned how to:\n1.  Define custom events.\n2.  Append events to a stream.\n3.  Process events to build a view (projection) of the system state.","src/content/docs/example.md","0adccb1ca373c9bf",{"html":56,"metadata":57},"\u003Ch1 id=\"example-bank-ledger\">Example: Bank Ledger\u003C/h1>\n\u003Cp>In this tutorial, we will build a simple \u003Cstrong>Bank Ledger\u003C/strong> application. We will track account balances by storing \u003Ccode>Deposit\u003C/code> and \u003Ccode>Withdraw\u003C/code> events.\u003C/p>\n\u003Ch2 id=\"1-setup\">1. Setup\u003C/h2>\n\u003Cp>Create a new Rust project:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">cargo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> new\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> bank_ledger\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">cd\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> bank_ledger\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Add dependencies to \u003Ccode>Cargo.toml\u003C/code>:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"toml\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[\u003C/span>\u003Cspan style=\"color:#B392F0\">dependencies\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">varvedb = { path = \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"../varvedb\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> } \u003C/span>\u003Cspan style=\"color:#6A737D\"># Adjust path if needed\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">rkyv = \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"0.8\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">tokio = { version = \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"1\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, features = [\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"full\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"macros\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">serde = { version = \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"1\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, features = [\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"derive\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">anyhow = \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"1.0\"\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"2-define-events\">2. Define Events\u003C/h2>\n\u003Cp>Weâ€™ll define an enum to represent our transaction events.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"rust\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> rkyv\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003Cspan style=\"color:#B392F0\">Archive\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Serialize\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Deserialize\u003C/span>\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">#[derive(\u003C/span>\u003Cspan style=\"color:#B392F0\">Archive\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Serialize\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Deserialize\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Debug\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Clone\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">#[rkyv(derive(\u003C/span>\u003Cspan style=\"color:#B392F0\">Debug\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">pub\u003C/span>\u003Cspan style=\"color:#F97583\"> enum\u003C/span>\u003Cspan style=\"color:#B392F0\"> BankEvent\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    AccountCreated\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> { owner\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> String\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> },\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    Deposited\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> { amount\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> u64\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> },\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    Withdrawn\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> { amount\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> u64\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> },\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"3-the-application-logic\">3. The Application Logic\u003C/h2>\n\u003Cp>Weâ€™ll create a main function that initializes the database, writes some transactions, and then processes them to calculate the final balance.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"rust\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> varvedb\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">storage\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003Cspan style=\"color:#B392F0\">Storage\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">StorageConfig\u003C/span>\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> varvedb\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">engine\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003Cspan style=\"color:#B392F0\">Writer\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Reader\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Processor\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">EventHandler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> varvedb\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">error\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">Result\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> std\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">collections\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">HashMap\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// ... BankEvent definition ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#B392F0\"> BalanceProjector\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    balances\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> HashMap\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#B392F0\">String\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">u64\u003C/span>\u003Cspan style=\"color:#E1E4E8\">>,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">impl\u003C/span>\u003Cspan style=\"color:#B392F0\"> EventHandler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#B392F0\">BankEvent\u003C/span>\u003Cspan style=\"color:#E1E4E8\">> \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#B392F0\"> BalanceProjector\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    fn\u003C/span>\u003Cspan style=\"color:#B392F0\"> handle\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;mut\u003C/span>\u003Cspan style=\"color:#79B8FF\"> self\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, event\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#B392F0\">ArchivedBankEvent\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#B392F0\"> Result\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;()> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // In a real app, we'd need the stream ID (account ID) here.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // For simplicity, let's assume a single global account for this demo,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // or we could embed the account ID in the event.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        match\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> event {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            ArchivedBankEvent\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">AccountCreated\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> { owner } \u003C/span>\u003Cspan style=\"color:#F97583\">=>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                println!\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"New account for: {}\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, owner);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            ArchivedBankEvent\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">Deposited\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> { amount } \u003C/span>\u003Cspan style=\"color:#F97583\">=>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                println!\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Depositing: {}\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, amount);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            ArchivedBankEvent\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">Withdrawn\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> { amount } \u003C/span>\u003Cspan style=\"color:#F97583\">=>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                println!\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Withdrawing: {}\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, amount);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        Ok\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">#[tokio\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">main]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">async\u003C/span>\u003Cspan style=\"color:#F97583\"> fn\u003C/span>\u003Cspan style=\"color:#B392F0\"> main\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() \u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#B392F0\"> anyhow\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">Result\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;()> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 1. Setup Storage\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> config \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> StorageConfig\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">default\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> storage \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> Storage\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">open\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(config)\u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#F97583\"> mut\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> writer \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> Writer\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#B392F0\">BankEvent\u003C/span>\u003Cspan style=\"color:#E1E4E8\">>\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">new\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(storage\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">clone\u003C/span>\u003Cspan style=\"color:#E1E4E8\">());\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> reader \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> Reader\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#B392F0\">BankEvent\u003C/span>\u003Cspan style=\"color:#E1E4E8\">>\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">new\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(storage\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">clone\u003C/span>\u003Cspan style=\"color:#E1E4E8\">());\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 2. Simulate Transactions\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> account_id \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"account-1\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Create Account\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    writer\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">append\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(account_id, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">BankEvent\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">AccountCreated\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> { \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        owner\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"Alice\"\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">to_string\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    })\u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Deposit 100\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    writer\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">append\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(account_id, \u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">BankEvent\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">Deposited\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> { amount\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 100\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> })\u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Withdraw 50\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    writer\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">append\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(account_id, \u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">BankEvent\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">Withdrawn\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> { amount\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 50\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> })\u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    println!\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Transactions committed.\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 3. Process Events\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rx \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> writer\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">subscribe\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> handler \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> BalanceProjector\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> { balances\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> HashMap\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">new\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Create a unique consumer ID\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    use\u003C/span>\u003Cspan style=\"color:#B392F0\"> std\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">hash\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003Cspan style=\"color:#B392F0\">Hash\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Hasher\u003C/span>\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#F97583\"> mut\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> hasher \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> std\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">collections\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">hash_map\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">DefaultHasher\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">new\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    \"balance-projector\"\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">hash\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;mut\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> hasher);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> consumer_id \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> hasher\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">finish\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#F97583\"> mut\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> processor \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> Processor\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">new\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(reader, handler, consumer_id, rx);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Run the processor (in a real app, this would be a background task)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // We'll run it in a separate task and wait a bit for it to catch up\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    tokio\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">spawn\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">async\u003C/span>\u003Cspan style=\"color:#F97583\"> move\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#F97583\"> let\u003C/span>\u003Cspan style=\"color:#B392F0\"> Err\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(e) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> processor\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">run\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003Cspan style=\"color:#F97583\">.await\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            eprintln!\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Processor error: {}\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, e);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    });\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Give the processor a moment to run\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    tokio\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">time\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">sleep\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#B392F0\">std\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">time\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">Duration\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">from_secs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003Cspan style=\"color:#F97583\">.await\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    Ok\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"4-running-the-example\">4. Running the Example\u003C/h2>\n\u003Cp>Run the application:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">cargo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> run\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>You should see the output reflecting the processed events.\u003C/p>\n\u003Ch2 id=\"conclusion\">Conclusion\u003C/h2>\n\u003Cp>Youâ€™ve built a simple event-sourced application with VarveDB! You learned how to:\u003C/p>\n\u003Col>\n\u003Cli>Define custom events.\u003C/li>\n\u003Cli>Append events to a stream.\u003C/li>\n\u003Cli>Process events to build a view (projection) of the system state.\u003C/li>\n\u003C/ol>",{"headings":58,"localImagePaths":77,"remoteImagePaths":78,"frontmatter":79,"imagePaths":80},[59,62,65,68,71,74],{"depth":22,"slug":60,"text":61},"example-bank-ledger","Example: Bank Ledger",{"depth":25,"slug":63,"text":64},"1-setup","1. Setup",{"depth":25,"slug":66,"text":67},"2-define-events","2. Define Events",{"depth":25,"slug":69,"text":70},"3-the-application-logic","3. The Application Logic",{"depth":25,"slug":72,"text":73},"4-running-the-example","4. Running the Example",{"depth":25,"slug":75,"text":76},"conclusion","Conclusion",[],[],{},[],"example.md","quick_start",{"id":82,"data":84,"body":85,"filePath":86,"digest":87,"rendered":88,"legacyId":108},{},"# Quick Start\n\nGet up and running with VarveDB in minutes.\n\n## Installation\n\nAdd `varvedb` to your `Cargo.toml`:\n\n```bash\ncargo add varvedb\n```\n\n## Hello World\n\nHere is a simple example of how to append an event and read it back.\n\n```rust\nuse varvedb::{Varve, Event};\nuse serde::{Serialize, Deserialize};\n\n#[derive(Serialize, Deserialize, Debug)]\nstruct UserSignedUp {\n    username: String,\n    email: String,\n}\n\n#[tokio::main]\nasync fn main() -> Result\u003C(), Box\u003Cdyn std::error::Error>> {\n    // 1. Initialize the database\n    let varve = Varve::open(\"my_db\").await?;\n    let mut writer = varve.writer().await?;\n    let reader = varve.reader()?;\n\n    // 2. Define an event\n    let event = UserSignedUp {\n        username: \"alice\".to_string(),\n        email: \"alice@example.com\".to_string(),\n    };\n\n    // 3. Append the event\n    let offset = writer.append(\"users\", &event).await?;\n    println!(\"Appended event at offset: {}\", offset);\n\n    // 4. Read it back\n    let read_event: UserSignedUp = reader.get(\"users\", offset)?;\n    println!(\"Read event: {:?}\", read_event);\n\n    Ok(())\n}\n```\n\n## Next Steps\n\n*   Check out the [Architecture](./architecture.md) to understand how VarveDB works.\n*   See the [Usage](./usage.md) guide for more advanced patterns.","src/content/docs/quick_start.md","ebfe1d9de1cc5262",{"html":89,"metadata":90},"\u003Ch1 id=\"quick-start\">Quick Start\u003C/h1>\n\u003Cp>Get up and running with VarveDB in minutes.\u003C/p>\n\u003Ch2 id=\"installation\">Installation\u003C/h2>\n\u003Cp>Add \u003Ccode>varvedb\u003C/code> to your \u003Ccode>Cargo.toml\u003C/code>:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">cargo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> add\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> varvedb\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"hello-world\">Hello World\u003C/h2>\n\u003Cp>Here is a simple example of how to append an event and read it back.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"rust\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> varvedb\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003Cspan style=\"color:#B392F0\">Varve\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Event\u003C/span>\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> serde\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003Cspan style=\"color:#B392F0\">Serialize\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Deserialize\u003C/span>\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">#[derive(\u003C/span>\u003Cspan style=\"color:#B392F0\">Serialize\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Deserialize\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Debug\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#B392F0\"> UserSignedUp\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    username\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> String\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    email\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> String\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">#[tokio\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">main]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">async\u003C/span>\u003Cspan style=\"color:#F97583\"> fn\u003C/span>\u003Cspan style=\"color:#B392F0\"> main\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() \u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#B392F0\"> Result\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;(), \u003C/span>\u003Cspan style=\"color:#B392F0\">Box\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#F97583\">dyn\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> std\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">error\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">Error\u003C/span>\u003Cspan style=\"color:#E1E4E8\">>> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 1. Initialize the database\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> varve \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> Varve\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">open\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"my_db\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">.await?\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#F97583\"> mut\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> writer \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> varve\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">writer\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003Cspan style=\"color:#F97583\">.await?\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> reader \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> varve\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">reader\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 2. Define an event\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> event \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> UserSignedUp\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        username\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"alice\"\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">to_string\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        email\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"alice@example.com\"\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">to_string\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 3. Append the event\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> offset \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> writer\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">append\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"users\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">event)\u003C/span>\u003Cspan style=\"color:#F97583\">.await?\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    println!\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Appended event at offset: {}\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, offset);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 4. Read it back\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> read_event\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> UserSignedUp\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> reader\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">get\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"users\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, offset)\u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    println!\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Read event: {:?}\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, read_event);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    Ok\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"next-steps\">Next Steps\u003C/h2>\n\u003Cul>\n\u003Cli>Check out the \u003Ca href=\"./architecture.md\">Architecture\u003C/a> to understand how VarveDB works.\u003C/li>\n\u003Cli>See the \u003Ca href=\"./usage.md\">Usage\u003C/a> guide for more advanced patterns.\u003C/li>\n\u003C/ul>",{"headings":91,"localImagePaths":104,"remoteImagePaths":105,"frontmatter":106,"imagePaths":107},[92,95,98,101],{"depth":22,"slug":93,"text":94},"quick-start","Quick Start",{"depth":25,"slug":96,"text":97},"installation","Installation",{"depth":25,"slug":99,"text":100},"hello-world","Hello World",{"depth":25,"slug":102,"text":103},"next-steps","Next Steps",[],[],{},[],"quick_start.md","usage",{"id":109,"data":111,"body":112,"filePath":113,"digest":114,"rendered":115,"legacyId":141},{},"# Usage\n\nThis guide covers how to install, configure, and use VarveDB in your Rust application.\n\n## Installation\n\nAdd `varvedb` to your `Cargo.toml`:\n\n```toml\n[dependencies]\nvarvedb = \"0.2\" # Check crates.io for the latest version\nrkyv = \"0.8\"\ntokio = { version = \"1\", features = [\"full\"] }\n```\n\n## Defining Events\n\nEvents in VarveDB must be serializable by `rkyv`. You need to derive `Archive`, `Serialize`, and `Deserialize`.\n\n```rust\nuse rkyv::{Archive, Serialize, Deserialize};\n\n#[derive(Archive, Serialize, Deserialize, Debug, Clone)]\n#[rkyv(derive(Debug))]\npub struct MyEvent {\n    pub id: u32,\n    pub action: String,\n    pub timestamp: u64,\n}\n```\n\n## Initialization\n\nTo start, you need to open the storage engine.\n\n```rust\nuse varvedb::storage::{Storage, StorageConfig};\n\nfn main() -> Result\u003C(), Box\u003Cdyn std::error::Error>> {\n    let config = StorageConfig {\n        path: \"./data\".into(),\n        encryption_enabled: true,\n        master_key: Some([0u8; 32]), // In production, load this from a secure location!\n        ..Default::default()\n    };\n    \n    let storage = Storage::open(config)?;\n    Ok(())\n}\n```\n\n## Writing Events\n\nUse the `Writer` to append events to a stream.\n\n```rust\nuse varvedb::engine::Writer;\n\n// ... storage initialization ...\n\nlet mut writer = Writer::\u003CMyEvent>::new(storage.clone());\n\n// Append an event to stream \"user-123\", expecting it to be empty (version 0)\nlet event = MyEvent { id: 1, action: \"login\".into(), timestamp: 1600000000 };\nwriter.append(\"user-123\", 0, event)?;\n```\n\n## Reading Events\n\nUse the `Reader` to access events.\n\n```rust\nuse varvedb::engine::Reader;\n\n// ... storage initialization ...\n\nlet reader = Reader::\u003CMyEvent>::new(storage.clone());\nlet txn = storage.env.read_txn()?;\n\n// Read the first event (global sequence 1)\nif let Some(event) = reader.get(&txn, 1)? {\n    println!(\"Event: {:?}\", event);\n}\n```\n\n## Processing Events\n\nTo process events in real-time, implement the `EventHandler` trait and use the `Processor`.\n\n```rust\nuse varvedb::engine::{Processor, EventHandler};\nuse varvedb::ArchivedMyEvent; // Generated by rkyv\n\nstruct MyHandler;\n\nimpl EventHandler\u003CMyEvent> for MyHandler {\n    fn handle(&mut self, event: &ArchivedMyEvent) -> varvedb::error::Result\u003C()> {\n        println!(\"Handling event: {:?}\", event);\n        Ok(())\n    }\n}\n\n// ... inside async runtime ...\n\nlet rx = writer.subscribe();\n\n// Create a unique consumer ID (e.g., by hashing a string)\nuse std::hash::{Hash, Hasher};\nlet mut hasher = std::collections::hash_map::DefaultHasher::new();\n\"my-consumer-group\".hash(&mut hasher);\nlet consumer_id = hasher.finish();\n\nlet mut processor = Processor::new(reader, MyHandler, consumer_id, rx);\n\n// This will run indefinitely, processing new events as they arrive\nprocessor.run().await?;\n```","src/content/docs/usage.md","4dd342e99f2d9637",{"html":116,"metadata":117},"\u003Ch1 id=\"usage\">Usage\u003C/h1>\n\u003Cp>This guide covers how to install, configure, and use VarveDB in your Rust application.\u003C/p>\n\u003Ch2 id=\"installation\">Installation\u003C/h2>\n\u003Cp>Add \u003Ccode>varvedb\u003C/code> to your \u003Ccode>Cargo.toml\u003C/code>:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"toml\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[\u003C/span>\u003Cspan style=\"color:#B392F0\">dependencies\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">varvedb = \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"0.2\"\u003C/span>\u003Cspan style=\"color:#6A737D\"> # Check crates.io for the latest version\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">rkyv = \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"0.8\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">tokio = { version = \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"1\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, features = [\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"full\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] }\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"defining-events\">Defining Events\u003C/h2>\n\u003Cp>Events in VarveDB must be serializable by \u003Ccode>rkyv\u003C/code>. You need to derive \u003Ccode>Archive\u003C/code>, \u003Ccode>Serialize\u003C/code>, and \u003Ccode>Deserialize\u003C/code>.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"rust\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> rkyv\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003Cspan style=\"color:#B392F0\">Archive\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Serialize\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Deserialize\u003C/span>\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">#[derive(\u003C/span>\u003Cspan style=\"color:#B392F0\">Archive\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Serialize\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Deserialize\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Debug\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Clone\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">#[rkyv(derive(\u003C/span>\u003Cspan style=\"color:#B392F0\">Debug\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">pub\u003C/span>\u003Cspan style=\"color:#F97583\"> struct\u003C/span>\u003Cspan style=\"color:#B392F0\"> MyEvent\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    pub\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> id\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    pub\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> action\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> String\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    pub\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> timestamp\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> u64\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"initialization\">Initialization\u003C/h2>\n\u003Cp>To start, you need to open the storage engine.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"rust\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> varvedb\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">storage\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003Cspan style=\"color:#B392F0\">Storage\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">StorageConfig\u003C/span>\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">fn\u003C/span>\u003Cspan style=\"color:#B392F0\"> main\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() \u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#B392F0\"> Result\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;(), \u003C/span>\u003Cspan style=\"color:#B392F0\">Box\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#F97583\">dyn\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> std\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">error\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">Error\u003C/span>\u003Cspan style=\"color:#E1E4E8\">>> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> config \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> StorageConfig\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        path\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"./data\"\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">into\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        encryption_enabled\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#79B8FF\"> true\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        master_key\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> Some\u003C/span>\u003Cspan style=\"color:#E1E4E8\">([\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#B392F0\">u8\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#79B8FF\">32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]), \u003C/span>\u003Cspan style=\"color:#6A737D\">// In production, load this from a secure location!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        ..\u003C/span>\u003Cspan style=\"color:#B392F0\">Default\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">default\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> storage \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> Storage\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">open\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(config)\u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    Ok\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"writing-events\">Writing Events\u003C/h2>\n\u003Cp>Use the \u003Ccode>Writer\u003C/code> to append events to a stream.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"rust\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> varvedb\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">engine\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">Writer\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// ... storage initialization ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">let\u003C/span>\u003Cspan style=\"color:#F97583\"> mut\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> writer \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> Writer\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#B392F0\">MyEvent\u003C/span>\u003Cspan style=\"color:#E1E4E8\">>\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">new\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(storage\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">clone\u003C/span>\u003Cspan style=\"color:#E1E4E8\">());\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Append an event to stream \"user-123\", expecting it to be empty (version 0)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> event \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> MyEvent\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> { id\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, action\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"login\"\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">into\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(), timestamp\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1600000000\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">writer\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">append\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"user-123\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, event)\u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"reading-events\">Reading Events\u003C/h2>\n\u003Cp>Use the \u003Ccode>Reader\u003C/code> to access events.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"rust\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> varvedb\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">engine\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">Reader\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// ... storage initialization ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> reader \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> Reader\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#B392F0\">MyEvent\u003C/span>\u003Cspan style=\"color:#E1E4E8\">>\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">new\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(storage\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">clone\u003C/span>\u003Cspan style=\"color:#E1E4E8\">());\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> txn \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> storage\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#E1E4E8\">env\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">read_txn\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Read the first event (global sequence 1)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">if\u003C/span>\u003Cspan style=\"color:#F97583\"> let\u003C/span>\u003Cspan style=\"color:#B392F0\"> Some\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(event) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> reader\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">get\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">txn, \u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    println!\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Event: {:?}\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, event);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"processing-events\">Processing Events\u003C/h2>\n\u003Cp>To process events in real-time, implement the \u003Ccode>EventHandler\u003C/code> trait and use the \u003Ccode>Processor\u003C/code>.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"rust\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> varvedb\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">engine\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003Cspan style=\"color:#B392F0\">Processor\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">EventHandler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> varvedb\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">ArchivedMyEvent\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#6A737D\">// Generated by rkyv\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#B392F0\"> MyHandler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">impl\u003C/span>\u003Cspan style=\"color:#B392F0\"> EventHandler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#B392F0\">MyEvent\u003C/span>\u003Cspan style=\"color:#E1E4E8\">> \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#B392F0\"> MyHandler\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    fn\u003C/span>\u003Cspan style=\"color:#B392F0\"> handle\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;mut\u003C/span>\u003Cspan style=\"color:#79B8FF\"> self\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, event\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#B392F0\">ArchivedMyEvent\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#B392F0\"> varvedb\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">error\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">Result\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;()> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        println!\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Handling event: {:?}\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, event);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        Ok\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// ... inside async runtime ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rx \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> writer\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">subscribe\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Create a unique consumer ID (e.g., by hashing a string)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> std\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">hash\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003Cspan style=\"color:#B392F0\">Hash\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">Hasher\u003C/span>\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">let\u003C/span>\u003Cspan style=\"color:#F97583\"> mut\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> hasher \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> std\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">collections\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">hash_map\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">DefaultHasher\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">new\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">\"my-consumer-group\"\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">hash\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;mut\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> hasher);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> consumer_id \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> hasher\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">finish\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">let\u003C/span>\u003Cspan style=\"color:#F97583\"> mut\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> processor \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> Processor\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">new\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(reader, \u003C/span>\u003Cspan style=\"color:#B392F0\">MyHandler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, consumer_id, rx);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// This will run indefinitely, processing new events as they arrive\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">processor\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">run\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003Cspan style=\"color:#F97583\">.await?\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\u003C/code>\u003C/pre>",{"headings":118,"localImagePaths":137,"remoteImagePaths":138,"frontmatter":139,"imagePaths":140},[119,121,122,125,128,131,134],{"depth":22,"slug":109,"text":120},"Usage",{"depth":25,"slug":96,"text":97},{"depth":25,"slug":123,"text":124},"defining-events","Defining Events",{"depth":25,"slug":126,"text":127},"initialization","Initialization",{"depth":25,"slug":129,"text":130},"writing-events","Writing Events",{"depth":25,"slug":132,"text":133},"reading-events","Reading Events",{"depth":25,"slug":135,"text":136},"processing-events","Processing Events",[],[],{},[],"usage.md","introduction",{"id":142,"data":144,"body":145,"filePath":146,"digest":147,"rendered":148,"legacyId":167},{},"> [!WARNING]\n> **UNDER DEVELOPMENT**: This project is currently in early development and is **NOT** production ready. APIs and storage formats are subject to change.\n\n# Introduction\n\n**VarveDB** is a high-performance, embedded, append-only event store for Rust. It is designed to provide a persistent, ACID-compliant event log optimized for high-throughput event sourcing applications.\n\nBy leveraging **LMDB** (Lightning Memory-Mapped Database) for reliable storage and **rkyv** for zero-copy deserialization, VarveDB ensures minimal overhead and maximum performance.\n\n## Key Features\n\n*   **Zero-Copy Access**: Events are mapped directly from disk to memory using `rkyv`, avoiding expensive deserialization steps.\n*   **ACID Transactions**: Writes are Atomic, Consistent, Isolated, and Durable.\n*   **Optimistic Concurrency**: Built-in stream versioning prevents race conditions and ensures data integrity.\n*   **Reactive Interface**: Real-time event subscriptions via `tokio::watch` allow for building responsive, event-driven systems.\n*   **Authenticated Encryption**: Optional AES-256-GCM encryption with Additional Authenticated Data (AAD) binding ensures data security at rest.\n*   **GDPR Compliance**: Support for crypto-shredding via key deletion allows for compliant data removal.\n\n## Why VarveDB?\n\nVarveDB fills the gap for a lightweight, embedded event store in the Rust ecosystem. Unlike heavy external databases like Kafka or EventStoreDB, VarveDB runs directly within your application process. This makes it ideal for:\n\n*   **Microservices**: Keep your services self-contained with their own event logs.\n*   **IoT and Edge Devices**: Efficient storage with low resource footprint.\n*   **High-Frequency Trading**: Ultra-low latency event persistence.\n*   **Local-First Applications**: robust data storage for offline-capable apps.\n\n## Core Concepts\n\n*   **Stream**: An ordered sequence of events, identified by a `StreamID`.\n*   **Event**: The fundamental unit of data, which can be any serializable Rust struct.\n*   **Writer**: Appends events to the store.\n*   **Reader**: Reads events from the store.\n*   **Processor**: Subscribes to new events and processes them in real-time.","src/content/docs/introduction.md","8656e24117be1f71",{"html":149,"metadata":150},"\u003Cblockquote>\n\u003Cp>[!WARNING]\n\u003Cstrong>UNDER DEVELOPMENT\u003C/strong>: This project is currently in early development and is \u003Cstrong>NOT\u003C/strong> production ready. APIs and storage formats are subject to change.\u003C/p>\n\u003C/blockquote>\n\u003Ch1 id=\"introduction\">Introduction\u003C/h1>\n\u003Cp>\u003Cstrong>VarveDB\u003C/strong> is a high-performance, embedded, append-only event store for Rust. It is designed to provide a persistent, ACID-compliant event log optimized for high-throughput event sourcing applications.\u003C/p>\n\u003Cp>By leveraging \u003Cstrong>LMDB\u003C/strong> (Lightning Memory-Mapped Database) for reliable storage and \u003Cstrong>rkyv\u003C/strong> for zero-copy deserialization, VarveDB ensures minimal overhead and maximum performance.\u003C/p>\n\u003Ch2 id=\"key-features\">Key Features\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Cstrong>Zero-Copy Access\u003C/strong>: Events are mapped directly from disk to memory using \u003Ccode>rkyv\u003C/code>, avoiding expensive deserialization steps.\u003C/li>\n\u003Cli>\u003Cstrong>ACID Transactions\u003C/strong>: Writes are Atomic, Consistent, Isolated, and Durable.\u003C/li>\n\u003Cli>\u003Cstrong>Optimistic Concurrency\u003C/strong>: Built-in stream versioning prevents race conditions and ensures data integrity.\u003C/li>\n\u003Cli>\u003Cstrong>Reactive Interface\u003C/strong>: Real-time event subscriptions via \u003Ccode>tokio::watch\u003C/code> allow for building responsive, event-driven systems.\u003C/li>\n\u003Cli>\u003Cstrong>Authenticated Encryption\u003C/strong>: Optional AES-256-GCM encryption with Additional Authenticated Data (AAD) binding ensures data security at rest.\u003C/li>\n\u003Cli>\u003Cstrong>GDPR Compliance\u003C/strong>: Support for crypto-shredding via key deletion allows for compliant data removal.\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"why-varvedb\">Why VarveDB?\u003C/h2>\n\u003Cp>VarveDB fills the gap for a lightweight, embedded event store in the Rust ecosystem. Unlike heavy external databases like Kafka or EventStoreDB, VarveDB runs directly within your application process. This makes it ideal for:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Microservices\u003C/strong>: Keep your services self-contained with their own event logs.\u003C/li>\n\u003Cli>\u003Cstrong>IoT and Edge Devices\u003C/strong>: Efficient storage with low resource footprint.\u003C/li>\n\u003Cli>\u003Cstrong>High-Frequency Trading\u003C/strong>: Ultra-low latency event persistence.\u003C/li>\n\u003Cli>\u003Cstrong>Local-First Applications\u003C/strong>: robust data storage for offline-capable apps.\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"core-concepts\">Core Concepts\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Cstrong>Stream\u003C/strong>: An ordered sequence of events, identified by a \u003Ccode>StreamID\u003C/code>.\u003C/li>\n\u003Cli>\u003Cstrong>Event\u003C/strong>: The fundamental unit of data, which can be any serializable Rust struct.\u003C/li>\n\u003Cli>\u003Cstrong>Writer\u003C/strong>: Appends events to the store.\u003C/li>\n\u003Cli>\u003Cstrong>Reader\u003C/strong>: Reads events from the store.\u003C/li>\n\u003Cli>\u003Cstrong>Processor\u003C/strong>: Subscribes to new events and processes them in real-time.\u003C/li>\n\u003C/ul>",{"headings":151,"localImagePaths":163,"remoteImagePaths":164,"frontmatter":165,"imagePaths":166},[152,154,157,160],{"depth":22,"slug":142,"text":153},"Introduction",{"depth":25,"slug":155,"text":156},"key-features","Key Features",{"depth":25,"slug":158,"text":159},"why-varvedb","Why VarveDB?",{"depth":25,"slug":161,"text":162},"core-concepts","Core Concepts",[],[],{},[],"introduction.md"]